{% extends "layout.html" %}

{% block content %}

<style>
    .flashes {
        text-align: center;
    }
</style>

{% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul class=flashes>
    {% for message in messages %}
        {{ message }}
    {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<div>
    <h2>{{ contractor.name }}</h2>

    {% if contractor.business_id %}
    {{ _("business_id") }}: {{ contractor.business_id }}
    {% else %}
    {{ _("private_contractor") }}
    {% endif %}

    <p>
    <form action="{{ url_for('main.contractor_location_bp.add') }}">
        <input type="submit"value="{{ _('add_contractor_location_button') }}" />
    </form>
    </p>
</div>

<h3>{{ _("ml_locations_header") }}</h3>

{% for location in locations %}

    <div class="card">
        <h3>{{ location[0].address }}</h3>
        {{ _("maximum_distance") }} (km): {% if location[0].delivery_radius == -1 %} {{ _("no_limit") }} {% else %} {{ location[0].delivery_radius }} {% endif %}
        <p>
        <form action="{{ url_for('main.contractor_location_bp.remove') }}" method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="hidden" name="location_id" value="{{ location[0].id }}">
            <input type="submit" value="{{ _('remove_location_button') }}">
        </form>
        </p>

        <p><h4>{{ _("contractor_location_material_types") }}:</h4></p>
        {% for sidestream in location[1] %}
    
            <pre>{{ sidestream.unit.value }}   {{ _("material_price") }} (€/km): {{ sidestream.price_per_km }}    {{ _("base_rate") }}: {{ sidestream.base_rate }}€    {{ _("max_capacity") }}: {{ sidestream.max_capacity }}{{ sidestream.unit.value }}    {{ _("maximum_distance") }}: {{ sidestream.max_distance }}km  {{ _("can_process") }}: {{ sidestream.can_process }}   {{ _("description") }}: {{ sidestream.description }}</pre>
            <form action="{{ url_for('main.cargo_bp.remove') }}" method="POST">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <input type="hidden" name="cargo_id" value="{{ sidestream.id }}">
                <input type="submit" value="{{ _('remove_material_button') }}">
            </form>
        {% else %}
          {{ _("no_material_types_added_message") }}
        {% endfor %}
    </div>

{% else %}
  {{ _("no_locations_added_message") }}
{% endfor %}

{% endblock %}